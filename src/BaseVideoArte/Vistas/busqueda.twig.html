{% extends 'layout.twig.html' %}

{% block title %}Buscador{% endblock %}
{% block js%}<script type="text/javascript" src="{{app.request.basepath}}/js/libs/jquery-1.5.2.min.js"></script>
<script type="text/javascript" src="{{app.request.basepath}}/js/buscador.js"></script>
{%block css%}{%endblock%}

{%endblock%}

{% block contenido %}
<div class="tab">
	<a href="#form_general">General</a>
	<a href="#form_personas">Personas</a>
	<a href="#form_obras">Obras</a>
	<div class="clear"> </div>
</div>

<div class="tab_form">
	<div id="form_general">
		<form id="busqueda_general" action="{{ path('busqueda') }}" method="post" >
			{{form_row(form_general.consulta) }}
			{{form_row(form_general.buscar) }}
			{{ form_rest(form_general) }}
		</form>
	</div>

	<div id="form_personas">
		<form id="busqueda_personas" action="{{ path('busqueda') }}" method="post" >
			{{form_row(form_personas.nombre) }}
			{{form_row(form_personas.sexo) }}
			{{form_row(form_personas.pais) }}
			{{form_row(form_personas.tipo) }}
			{{form_row(form_personas.buscar) }}
			 {{ form_rest(form_personas) }}

		</form>
	</div>
	
	<div id="form_obras">
		<form id="busqueda_obras" action="{{ path('busqueda') }}" method="post" >
			{{form_widget(form_obras) }}
			{{ form_rest(form_obras) }}

		</form>
	</div>
</div>

<div id="resultado_busqueda">
	{{respuesta.mensaje}}
	{%set titulo = ''%}
	{%for resultado in respuesta.resultado%}
		{% if titulo != resultado.entidad%}
			{% set titulo = resultado.entidad%}
			<h2>{{titulo}}</h2>
		{%endif%}
		
		
		{%if resultado.entidad == 'obras' %}
			<a href="{{path('obra',{obra: resultado.link}) }}"><h3>{{resultado.encabezado}}</h3></a>
		{%endif %}
		
		{%if resultado.entidad == 'personas' %}
			<a href="{{ path('persona',{persona: resultado.link}) }}"><h3>{{resultado.encabezado}}</h3></a>
		{%endif %}
		
		
	{%endfor%}
	
</div>

{% endblock %}
